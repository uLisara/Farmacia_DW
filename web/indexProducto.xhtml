<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
        <meta name="viewport" content="width=device-width"></meta>
                <link  href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"/>
    </h:head>
    <h:body>
        <c:forEach items="#{managedProducto.listaPro}" var="a">
            <h:form>
                <div class="card" style="width: 20rem;align-self: center"><br></br>
                    <h:graphicImage value="#{a.imagen}"
                                    height="100" width="100" style="align-self: center" />
                    <div class="card-body" style="align-content: center">
                        <h:outputText value="#{a.nombrepro}" class="card-title" style="align-content: center;"/><br/>
                        <h:outputText value="#{a.idpro}" style="align-self: center;"></h:outputText><br/>
                        <h:outputText title="Precio" value="#{a.preciopro}" style="align-self: center;"/><br></br>
                        <h:outputText title="Stock" value="#{a.stockpro}" style="align-self: center;" /><br></br>
                        
                        <p:spinner id="minMax" value="#{managedDetallePedido.spin}" min="0" max="#{a.stockpro}" style="align-items: center" >
                            </p:spinner>
                        
                        <h:commandButton class="btn btn-primary" value="Agregar al Carrito" actionListener="#{managedDetallePedido.agregaCarrito(a)}" ></h:commandButton>
                    </div>
                </div>
            </h:form> 
        </c:forEach>
        
        <h:form>
            <h:dataTable value="#{managedDetallePedido.listCarrito}" var="c">
                <h:column>
                    <f:facet name="header">
                        <h:outputText value="Codigo"/>
                    </f:facet>
                    <h:outputText value="#{c.idproductodetallepe.idpro}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        <h:outputText value="Nombre"/>
                    </f:facet>
                    <h:outputText value="#{c.idproductodetallepe.nombrepro}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        <h:outputText value="Cantidad"/>
                    </f:facet>
                    <h:outputText value="#{c.cantidaddetellepe}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        <h:outputText value="Precio U"/>
                    </f:facet>
                    <h:outputText value="#{c.idproductodetallepe.preciopro}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        <h:outputText value="Accion:"/>
                    </f:facet>
                    <h:commandButton value="Eliminar" actionListener="#{managedDetallePedido.eliminarProductoCarrito(c.idproductodetallepe.idpro)}"/>
                </h:column>
                <h:column>
                    <f:facet name="header">
                        <h:outputText value="Precio Total"/>
                    </f:facet>
                    <h:outputText value="#{c.totaldetallepe}"></h:outputText>
                </h:column>
            </h:dataTable>
            <h:outputText value="Total a pagar: #{managedDetallePedido.total}"/>
        </h:form>
    </h:body>
</html>

